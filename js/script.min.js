function has(e,t){return e.indexOf(t)>-1}function doCommand(){var e=new Command;Game.execute(e)}var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),constants={defaultPlayerName:"player",startLocation:"westRoom",endMarker:".",invalidCommand:"Invalid Command",emptyInventory:"Your inventory is empty",noExit:"There is no exit in that direction",testCode:!0},variables={gameStepText:[],gameText:[]},Game=function(){function e(){}return e.print=function(t){t==constants.endMarker?(variables.gameText=variables.gameStepText.concat(variables.gameText),e.updateGameScreen(),variables.gameStepText=[]):variables.gameStepText.push(t)},e.reset=function(){player.reset(),Room.reset()},e.execute=function(t){if(e.print(t.toString()),e.commandHistory.push(t),t.checkValidity())switch(t.verb){case"help":Command.generateHelp();break;case"look":Room.roomList[player.location].describe();break;case"go":player.moveTo(t.object);break;case"ls":player.printInventory(),e.print(".."),Room.roomList[player.location].describe();break;case"inventory":player.printInventory();break;case"reset":e.reset(),e.print("Game reset");break;default:e.print(constants.invalidCommand)}else t.missedExtra?e.print(t.missedExtra):e.print(constants.invalidCommand);e.print(constants.endMarker),e.updateInventory()},e.updateInventory=function(){document.getElementById("inventory").innerHTML="Inventory : "+player.toStringInventory()},e.updateGameScreen=function(){var e=document.getElementById("gameText"),t=document.createElement("div"),n=document.createElement("pre");for(var o in variables.gameStepText)n.textContent+=variables.gameStepText[o]+"\n",t.appendChild(n);e.insertBefore(t,e.firstChild)},e}();Game.savedCommands={},Game.commandHistory=[];var Command=function(){function e(e){var t=document.getElementById("command").value,n=t.split(/\s+/);this.verb=n.shift(),this.object=n.join(" "),e&&(this.verb=e),this.checkValidity(),document.getElementById("command").value=""}return e.prototype.toString=function(){return this.verb+" "+this.object},e.generateHelp=function(){Game.print("The following commands are available");for(var t in e.commands){var n=e.commands[t],o=n.extra?" "+n.extra:"",r=t+o;if(n.alternatives)for(var i=0,a=n.alternatives;i<a.length;i++){var s=a[i];r+="/ "+s+o}Game.print(r+" : "+n.desc),n.extraDescription&&Game.print(n.extraDescription)}},e.prototype.checkValidity=function(){if(""==this.verb)return!1;for(var t in e.commands){if(t==this.verb)return!e.commands[t].extra||""!=this.object||(this.missedExtra=e.commands[t].missedExtra,!1);if(e.commands[t].alternatives&&has(e.commands[t].alternatives,this.verb))return e.commands[t].extra&&""==this.object?(this.missedExtra=e.commands[t].missedExtra,!1):(this.verb=t,!0);if(e.commands[t].shortcut)for(var n in e.commands[t].shortcut)if(this.verb==n)return this.verb=e.commands[t].shortcut[n][0],this.object=e.commands[t].shortcut[n][1],!0}return!1},e}();Command.commands={inventory:{desc:"Print inventory",alternatives:["inv"]},look:{desc:"Give description of the room you're in",alternatives:["info"]},go:{desc:"Go to the specified direction",alternatives:["move","walk"],extraDescription:"\tYou can also use north, east, south, west, up, down, n, e, s, w as well",extra:["[direction]"],shortcut:{north:["go","north"],n:["go","north"],south:["go","south"],s:["go","south"],east:["go","east"],e:["go","east"],west:["go","west"],w:["go","west"],up:["go","up"],down:["go","down"]},missedExtra:"Please specify direction to go"},take:{desc:"Take an object",alternatives:["pick","fill"],extra:"[object]",missedExtra:"Please specify what to take"},put:{desc:"Put an object",alternatives:["place","keep","fix","pour"],extra:"[object]",missedExtra:"Please specify what to put"},open:{desc:"Try to open the object",alternatives:["unlock"],extra:"[object]",missedExtra:"Please specify what to open"},attack:{desc:"Try to kill the enemy",alternatives:["kill"],extra:"[enemy]",missedExtra:"Please specify what to attack"},make:{desc:"Make object if the materials are present",alternatives:["craft","build"],extra:"[object]",missedExtra:"Please specify what to make"},ls:{desc:"Combination of inventory and look"},save:{desc:"Create a checkpoint that can be loaded later",extra:"[tag]",missedExtra:"Please specify tag to save under"},load:{desc:"Load a checkpoint that has been saved",extra:"[tag]",missedExtra:"Please specify tag to load from"},reset:{desc:"Start game from beginning again",alternatives:["redo","reboot","restart"]},clear:{desc:"Clear the screen of game text"},help:{desc:"Print this help menu"}};var Unique=function(){function e(){}return e}();Unique.ids=[];var Box=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.open=function(){},t}(Unique),Character=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n.inventory=[],n.location=constants.startLocation,n}return __extends(t,e),t.prototype.toStringInventory=function(){for(var e="",t=0,n=this.inventory;t<n.length;t++){var o=n[t];e+=o+", "}return e},t.prototype.inventoryEmpty=function(){return this.inventory.length<1},t.prototype.printInventory=function(){if(this.inventoryEmpty())Game.print(constants.emptyInventory);else{Game.print("You are carrying: ");for(var e=0,t=this.inventory;e<t.length;e++){var n=t[e];Game.print(n)}}},t.prototype.has=function(e){for(var t=0,n=this.inventory;t<n.length;t++){var o=n[t];return has(o,e),!0}return!1},t.prototype.reset=function(){this.location=constants.startLocation,this.inventory=[],constants.testCode&&(this.inventory=["some","stuff","other","good"])},t.prototype.moveTo=function(e){var t=Room.findOne(this.location);if(null!=t){console.log(t);var n=t.findExit(e);n?player.location=n.to:Game.print(constants.noExit)}else Game.print("Current location errored, please restart the game")},t}(Unique),Room=function(e){function t(t){var n=e.call(this)||this;return n.exits={},n.name=t,n}return __extends(t,e),t.findOne=function(e){if(e in t.roomList)return t.roomList[e];for(var n in t.roomList)if(t.roomList[n].shortDescription==e)return t.roomList[n];return null},t.prototype.findExit=function(e){return e in this.exits?this.exits[e]:null},t.reset=function(){t.roomList={};for(var e in t.roomListObject){var n=new t(e);n.shortDescription=t.roomListObject[e].shortDescription,n.description=t.roomListObject[e].description,t.roomList[e]=n}for(var e in t.roomListObject)for(var o in t.roomListObject[e].exits){var r=t.roomListObject[e].exits[o],i={};i.to=r.to,i.toRoom=t.findOne(r.to),i.locked=r.locked,t.roomList[e].exits[o]=i}},t.prototype.describe=function(){Game.print(this.shortDescription),Game.print(this.description)},t}(Unique);Room.roomListObject={westRoom:{shortDescription:"west room",description:"You are in the west end of a sloping east-west passage of barren rock.",interactible:{contents:["platinumKey","water"]},exits:{east:{to:"centerRoom"}}},centerRoom:{shortDescription:"center room",description:"the very heart of the dungeon, a windowless chamber lit only by the eerie light of glowing fungi high above. There is a prominent trophy stand in the middle, there is no trophy on it.",interactible:{contents:["copperKey"]},exits:{}}},Room.roomList={};var player=new Character(constants.defaultPlayerName);Game.reset(),window.onload=function(){var e=new Command("look");Game.execute(e),document.getElementById("command").focus()};